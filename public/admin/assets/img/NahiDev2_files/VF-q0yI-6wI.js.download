;/*FB_PKG_DELIM*/

__d("CometUFICommentListRenderer_feedback.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[{defaultValue:!0,kind:"LocalArgument",name:"canShowSeenState"},{kind:"RootArgument",name:"feedLocation"},{kind:"RootArgument",name:"feedbackSource"},{defaultValue:!0,kind:"LocalArgument",name:"shouldShowComments"}],kind:"Fragment",metadata:null,name:"CometUFICommentListRenderer_feedback",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:[{kind:"Variable",name:"feedback_source_integer",variableName:"feedbackSource"}],kind:"ScalarField",name:"is_eligible_for_enhanced_comment_updates",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_synced_qa_post",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"subscription_target_id",storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"associated_video",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"broadcast_is_ama_enabled",storageKey:null}],storageKey:null},{condition:"shouldShowComments",kind:"Condition",passingValue:!0,selections:[{alias:null,args:[{kind:"Variable",name:"location",variableName:"feedLocation"},{kind:"Literal",name:"supported",value:"4AxN2k"}],concreteType:null,kind:"LinkedField",name:"comment_list_renderer",plural:!1,selections:[{kind:"InlineFragment",selections:[{args:null,documentName:"CometUFICommentListRenderer_feedback",fragmentName:"CometUFICommentListRendererForCommentsAPI_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"XFBCommentListRendererForCommentsAPI",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometUFICommentListRenderer_feedback",fragmentName:"CometUFICommentListRendererForCommentsAPIPermalink_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"XFBCommentListRendererForCommentsAPIPermalink",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometUFICommentListRenderer_feedback",fragmentName:"CometUFICommentListRendererForCommentsAPIMediaViewer_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"XFBCommentListRendererForCommentsAPIMediaViewer",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometUFICommentListRenderer_feedback",fragmentName:"CometUFICommentListRendererForCommentsAPITahoe_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"XFBCommentListRendererForCommentsAPITahoe",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometUFICommentListRenderer_feedback",fragmentName:"CometUFICommentListRendererForCommentsAPITahoeWithLiveVOD_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"XFBCommentListRendererForCommentsAPITahoeWithLiveVOD",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometUFICommentListRenderer_feedback",fragmentName:"CometUFICommentListRendererForCommentsAPIWorkplaceKnowledgeNote_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"XFBCommentListRendererForCommentsAPIWorkplaceKnowledgeNote",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometUFICommentListRenderer_feedback",fragmentName:"CometUFICommentListRendererForCommentsAPIBizInbox_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"XFBCommentListRendererForCommentsAPIBizInbox",abstractKey:null},{kind:"InlineFragment",selections:[{args:null,documentName:"CometUFICommentListRenderer_feedback",fragmentName:"CometUFICommentListRendererForMediaViewerReply_renderer",fragmentPropName:"renderer",kind:"ModuleImport"}],type:"XFBCommentListRendererForMediaViewerReply",abstractKey:null}],storageKey:null}]}],type:"Feedback",abstractKey:null};e.exports=a}),null);
__d("CometUFIReparentedCommentIDsContext.react",["react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;c=b.createContext;b.useCallback;b.useMemo;var j=b.useState,k=c({addReparentedCommentIds:function(){},reparentedToDeletedCommentsMap:new Map()});function a(a){var b=d("react-compiler-runtime").c(7);a=a.children;var c;b[0]===Symbol["for"]("react.memo_cache_sentinel")?(c=new Map(),b[0]=c):c=b[0];c=j(c);var e=c[0],f=c[1];b[1]===Symbol["for"]("react.memo_cache_sentinel")?(c=function(a){f(function(b){a.forEach(function(a,c){b.set(c,a)});return b})},b[1]=c):c=b[1];c=c;b[2]!==e?(c={addReparentedCommentIds:c,reparentedToDeletedCommentsMap:e},b[2]=e,b[3]=c):c=b[3];e=c;c=e;b[4]!==a||b[5]!==c?(e=i.jsx(k.Provider,{value:c,children:a}),b[4]=a,b[5]=c,b[6]=e):e=b[6];return e}g.CometUFIReparentedCommentIDsContext=k;g.CometUFIReparentedCommentIDsContextProvider=a}),98);
__d("CometUFICommentListRenderer.react",["CometAdPreviewContext","CometRelay","CometUFICommentListComposerProvider.react","CometUFICommentListLayoutContext","CometUFICommentListRenderer_feedback.graphql","CometUFIFunnelLoggerConstants","CometUFIQPLInstanceKeyContext","CometUFIReparentedCommentIDsContext.react","ErrorGuard","FBLogger","UFI2RealtimeContainer.react","mergeRefs","react","requireDeferred","useBoolean","useCometUFICodedErrorDialog","useTriggeredStoryCTAHandler"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=j||(j=d("react"));e=j;var l=e.useCallback,m=e.useContext,n=e.useMemo,o=e.useRef,p=e.useState,q=c("requireDeferred")("CometUFIDeleteCommentSubscription").__setRef("CometUFICommentListRenderer.react"),r=c("requireDeferred")("CometUFIEditCommentSubscription").__setRef("CometUFICommentListRenderer.react"),s=c("requireDeferred")("CometUFIFeedbackCommentReactSubscription").__setRef("CometUFICommentListRenderer.react"),t=c("requireDeferred")("CometUFIFunnelLogger").__setRef("CometUFICommentListRenderer.react"),u=c("requireDeferred")("CometUFIWorkQACommentTypeUpdateSubscription").__setRef("CometUFICommentListRenderer.react");function a(a){var e=a.feedback,f=a.feedbackSource,g=a.feedLocation,j=a.focusCommentID,v=a.listRef,w=a.narrow,x=a.onActorSelected,y=a.onCommitCommentCreate,z=a.socialMarketplace;a=a.storyRenderLocation;var A=d("CometRelay").useFragment(h!==void 0?h:h=b("CometUFICommentListRenderer_feedback.graphql"),e);e=d("CometAdPreviewContext").useCometAdPreviewContext();var B=o(null),C=d("CometRelay").useRelayEnvironment(),D=c("useTriggeredStoryCTAHandler")(),E=D[0];D=p(null);var F=D[0];D=D[1];var G=p(null),H=G[0];G=G[1];var I=c("useBoolean")(!1),J=I.setTrue;I=I.value;var K=c("useCometUFICodedErrorDialog")(),L=K.errorDialog,M=K.setError;K=m(d("CometUFIReparentedCommentIDsContext.react").CometUFIReparentedCommentIDsContext);var N=K.addReparentedCommentIds,O=A==null?void 0:A.id,P=A==null?void 0:A.subscription_target_id;K=l(function(){var a;if(O==null||P==null)return null;var b=!1,d=[],e={dispose:function(){b=!0,d.forEach(function(a){return(i||(i=c("ErrorGuard"))).applyWithGuard(a,null,[])})}};s.onReady(function(a){if(!b){a=a.subscribe(C,{top_level_feedback_id:O},!1,!0);d.push(a.dispose)}});A&&A.is_eligible_for_enhanced_comment_updates===!0&&!((a=A.associated_video)!=null&&a.broadcast_is_ama_enabled)&&(q.onReady(function(a){if(!b){a=a.subscribe({addReparentedCommentIds:N,environment:C,feedbackSource:f,topLevelFeedbackID:O});d.push(a.dispose)}}),r.onReady(function(a){if(!b){a=a.subscribe({environment:C,topLevelFeedbackID:O});d.push(a.dispose)}}));A&&A.is_synced_qa_post===!0&&u.onReady(function(a){if(!b){a=a.subscribe({environment:C,feedbackID:O});d.push(a.dispose)}});return e},[C,A,O,f,P]);var Q=m(c("CometUFIQPLInstanceKeyContext")),R=l(function(a){t.onReady(function(a){return a.addPoint(Q,d("CometUFIFunnelLoggerConstants").CometUFIFunnelLoggerEvents.COMMENT_EDIT_ERROR)}),M(a)},[Q,M]),S=p(function(){return new Set()}),T=S[0];S=S[1];var U=p(function(){return new Set()}),V=U[0],W=U[1];U=l(function(a){if(a==null)return;var b=(a=a.node)==null?void 0:a.id;if(b==null){c("FBLogger")("ufi2").mustfix("Could not discern an `id` having received a realtime comment. Realtime comment handling might be broken. Investigate immediately.");return}W(function(a){return new Set(a).add(b)})},[]);var X=l(function(){E("COMMENT_BUTTON_TAP")},[E]),Y=n(function(){return c("mergeRefs")(v,B)},[v]),Z=n(function(){return{narrow:w}},[w]);if(O==null){c("FBLogger")("ufi2").mustfix("No id on feedback when fetching from relay story in CometUFICommentListRenderer, this indicates relays store/environment has been bonkered some how");return null}var $=A==null?void 0:A.comment_list_renderer;F=k.jsx(d("CometRelay").MatchContainer,{match:$,props:{editingCommentID:F,feedbackSource:f,feedLocation:g,focusCommentID:j,handleCreateCommentProps:{onCommit:y,setError:M,setLocallyComposedCommentIds:S},listRef:Y,locallyComposedCommentIds:T,onActorSelected:x,onComposerFocusCallback:X,onEditCommentError:R,onRealtimeCommentReceived:U,onTranslateAllClick:J,realtimeCommentIds:V,renderedTranslationCommentID:H,renderer:$,setEditingCommentID:D,setRenderedTranslationCommentID:G,shouldRequestTranslationForAllComments:I,socialMarketplace:z===!0,storyRenderLocation:a,useDefaultActor:!1}});return e===!0?null:k.jsxs(c("UFI2RealtimeContainer.react"),{subscribe:K,children:[k.jsx(d("CometUFIReparentedCommentIDsContext.react").CometUFIReparentedCommentIDsContextProvider,{children:k.jsx(c("CometUFICommentListComposerProvider.react"),{children:k.jsx(c("CometUFICommentListLayoutContext").Provider,{value:Z,children:F})})}),L]})}a.displayName=a.name+" [from "+f.id+"]";e=k.memo(a);g["default"]=e}),98);
__d("useCometUFISubscriptionManager",["FBLogger","JSScheduler","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i;b=h||d("react");b.useCallback;var j=b.useRef;function a(){var a=d("react-compiler-runtime").c(6),b;a[0]===Symbol["for"]("react.memo_cache_sentinel")?(b=new Set(),a[0]=b):b=a[0];var e=j(b);a[1]===Symbol["for"]("react.memo_cache_sentinel")?(b=new Set(),a[1]=b):b=a[1];var f=j(b),g=j(!1);a[2]===Symbol["for"]("react.memo_cache_sentinel")?(b=function(a){e.current.add(a);g.current&&a.subscribe();return{dispose:function(){a.unsubscribe(),e.current["delete"](a)}}},a[2]=b):b=a[2];b=b;var h;a[3]===Symbol["for"]("react.memo_cache_sentinel")?(h=function(){g.current||(g.current=!0,e.current.forEach(function(a){var b=(i||(i=d("JSScheduler"))).scheduleSpeculativeCallback(function(){!g.current?c("FBLogger")("ufi2").mustfix("Scheduled callback to activate subscription was not canceled"):(f.current["delete"](b),a.subscribe())});f.current.add(b)}))},a[3]=h):h=a[3];h=h;var m;a[4]===Symbol["for"]("react.memo_cache_sentinel")?(m=function(){g.current&&(g.current=!1,e.current.forEach(l),f.current.forEach(k),f.current.clear())},a[4]=m):m=a[4];m=m;a[5]===Symbol["for"]("react.memo_cache_sentinel")?(b=[b,h,m],a[5]=b):b=a[5];return b}function k(a){return(i||(i=d("JSScheduler"))).cancelCallback(a)}function l(a){return a.unsubscribe()}g["default"]=a}),98);
__d("CometUFIRealtimeRoot.react",["UFI2RealtimeContext","react","react-compiler-runtime","useCometUFISubscriptionManager"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react")),j=h.useEffect;function a(a){var b=d("react-compiler-runtime").c(8),e=a.children;a=a.enabled;var f=a===void 0?!0:a;a=c("useCometUFISubscriptionManager")();var g=a[0],h=a[1],k=a[2],l;b[0]!==f||b[1]!==h||b[2]!==k?(a=function(){if(f){h();return function(){k()}}},l=[f,h,k],b[0]=f,b[1]=h,b[2]=k,b[3]=a,b[4]=l):(a=b[3],l=b[4]);j(a,l);b[5]!==g||b[6]!==e?(a=i.jsx(c("UFI2RealtimeContext").Provider,{value:g,children:e}),b[5]=g,b[6]=e,b[7]=a):a=b[7];return a}g["default"]=a}),98);