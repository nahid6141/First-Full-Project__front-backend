;/*FB_PKG_DELIM*/

__d("LSDecryptProtobuf",["LSArrayGetObjectAt","LSBase64Decode.nop","LSCreateDerivedKeys.nop","LSGetBlobFromString.nop","LSLogMebClientEvent.nop","LSSymmetricEncryptionCreateDecryptedData.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][decryptProtobuf] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[8]=a[1]==null?c.i64.cast([0,0]):a[1],d[2]=c.i64.of_int32(a[3].length),c.i64.eq(d[2],c.i64.cast([0,1]))?c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[3],c.i64.cast([0,0])).then(function(a){return a=a,d[12]=a[0],d[13]=a[1],a})},function(e){return d[14]=d[12].get("epoch_anon_id"),d[15]=d[12].get("epoch_root_key"),d[16]=c.createArray(),d[26]=(d[16].push(c.i64.cast([0,32])),d[16]),c.i64.ge(d[8],c.i64.cast([0,3]))?c.resolve(d[17]=void 0):c.sequence([function(e){return c.nativeOperation(b("LSGetBlobFromString.nop"),a[2]).then(function(a){return a=a,d[26]=a[0],a})},function(a){return d[17]=d[26]}])},function(e){return c.i64.ge(d[8],c.i64.cast([0,4]))?(d[26]="_",d[18]=["message_key_in_epoch",d[26],c.blobs.to_string(d[14]),d[26],"cipher_version",d[26],c.i64.to_string(d[8]),d[26],"thread",d[26],a[2]==null?"":a[2]].join("")):(c.i64.ge(d[8],c.i64.cast([0,3]))?(d[27]="_",d[26]=["message_key_in_epoch",d[27],c.blobs.to_string(d[14]),d[27],"cipher_version",d[27],c.i64.to_string(d[8]),d[27],"thread",d[27],a[2]==null?"":a[2]].join("")):(c.i64.ge(d[8],c.i64.cast([0,2]))?(d[28]="_",d[27]=["message_key_in_epoch",d[28],c.blobs.to_string(d[14]),d[28],"cipher_version",d[28],c.i64.to_string(d[8])].join("")):d[27]=["message_key_in_epoch","_",c.blobs.to_string(d[14])].join(""),d[26]=d[27]),d[18]=d[26]),c.nativeOperation(b("LSGetBlobFromString.nop"),d[18]).then(function(a){return a=a,d[19]=a[0],a})},function(a){return c.nativeOperation(b("LSCreateDerivedKeys.nop"),d[19],d[17],d[15],d[16]).then(function(a){return a=a,d[20]=a[0],a})},function(a){return d[20]?d[21]=!1:d[21]=!0,d[21]?c.resolve(d[22]=void 0):c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[20],c.i64.cast([0,0])).then(function(a){return a=a,d[26]=a[0],d[27]=a[1],a})},function(a){return d[22]=d[26]}])},function(e){return c.blobs.neq(d[22],void 0)?c.sequence([function(e){return c.nativeOperation(b("LSBase64Decode.nop"),a[0]).then(function(a){return a=a,d[26]=a[0],a})},function(e){return c.blobs.neq(d[26],void 0)?c.sequence([function(e){return c.nativeOperation(b("LSSymmetricEncryptionCreateDecryptedData.nop"),d[22],c.blobs.of_string(["message_thread","_",a[2]].join("")),d[26]).then(function(a){return a=a,d[29]=a[0],a})},function(a){return d[27]=d[29]}]):c.resolve(d[27]=void 0)},function(a){return c.blobs.neq(d[27],void 0)?c.resolve(d[28]=d[27]):c.sequence([function(a){return d[29]=["Failed to decrypt message. Epoch Anon ID: ",c.blobs.to_string(d[14]),", Encryption Version: ",c.i64.to_string(d[8])].join(""),function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][LSEncryptedBackupsDecryptProtobufStoredProcedure] ","",d[29]].join("")),d[30]=c.createArray(),void 0!==void 0?d[31]=(d[30].push(void 0),d[30]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDecryptProtobufStoredProcedure",[d[29]].join(""),d[30],c.i64.cast([0,3]))},function(a){return d[28]=void 0}])},function(a){return d[23]=d[28]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][LSEncryptedBackupsDecryptProtobufStoredProcedure] Decryption message key is null"),d[26]=c.createArray(),void 0!==void 0?d[27]=(d[26].push(void 0),d[26]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"LSEncryptedBackupsDecryptProtobufStoredProcedure","Decryption message key is null",d[26],c.i64.cast([0,3]))},function(a){return d[23]=void 0}])},function(a){return c.blobs.neq(d[23],void 0)?(a=[d[23],void 0],d[24]=a[0],d[25]=a[1],a):(d[26]=new c.Map(),d[26].set("error_code",c.i64.cast([0,101])),d[26].set("stored_procedure","LSEncryptedBackupsDecryptProtobufStoredProcedure"),d[26].set("error_message",""),a=[void 0,d[26]],d[24]=a[0],d[25]=a[1]),a=[d[24],d[25]],d[3]=a[0],d[4]=a[1]}]):c.resolve((d[12]=c.i64.of_int32(a[3].length),c.i64.eq(d[12],c.i64.cast([0,0]))?(d[15]=new c.Map(),d[15].set("error_code",c.i64.cast([0,102])),d[15].set("stored_procedure","LSEncryptedBackupsDecryptProtobufStoredProcedure"),d[15].set("error_message",""),e=[void 0,d[15]],d[13]=e[0],d[14]=e[1]):(d[15]=new c.Map(),d[15].set("error_code",c.i64.cast([0,103])),d[15].set("stored_procedure","LSEncryptedBackupsDecryptProtobufStoredProcedure"),d[15].set("error_message",""),e=[void 0,d[15]],d[13]=e[0],d[14]=e[1]),e=[d[13],d[14]],d[3]=e[0],d[4]=e[1]))},function(a){return d[5]=c.i64.of_float(Date.now()),d[6]=c.i64.random(),d[9]="Finishing execution. Execution time: ",d[10]=c.i64.to_string(c.i64.sub(d[5],d[0])),d[11]=" ms",d[7]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][decryptProtobuf] ",d[7],d[9],d[7],d[10],d[7],d[11]].join("")),c.i64.eq(c.i64.mod_(d[6],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[12]=",",d[13]=c.createArray(),void 0!==void 0?d[14]=(d[13].push(void 0),d[13]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"decryptProtobuf",[d[9],d[12],d[10],d[12],d[11]].join(""),d[13],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[3],d[4]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsDecryptProtobufStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSDecryptSupplementalKey",["LSArrayGetObjectAt","LSBase64Decode.nop","LSCreateDerivedKeys.nop","LSLogMebClientEvent.nop","LSSymmetricEncryptionCreateDecryptedData.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][decryptSupplementalKey] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.nativeOperation(b("LSBase64Decode.nop"),a[0]).then(function(a){return a=a,d[2]=a[0],a})},function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[1],c.i64.cast([0,0])).then(function(a){return a=a,d[3]=a[0],d[4]=a[1],a})},function(a){return c.blobs.neq(d[2],void 0)?c.sequence([function(a){return d[13]=d[3].get("epoch_root_key"),d[14]=c.createArray(),d[21]=(d[14].push(c.i64.cast([0,32])),d[14]),c.nativeOperation(b("LSCreateDerivedKeys.nop"),c.blob("a2RmX2luZm86bWFpbGJveF9yb290X2tleV92Mj5zdXBwbGVtZW50YWxfZW5jX2tleQ=="),void 0,d[13],d[14]).then(function(a){return a=a,d[15]=a[0],a})},function(a){return d[15]!==void 0?c.sequence([function(a){return d[21]=c.i64.of_int32(d[15].length),c.i64.ge(d[21],c.i64.cast([0,1]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[15],c.i64.cast([0,0])).then(function(a){return a=a,d[23]=a[0],d[24]=a[1],a})},function(a){return d[22]=d[23]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM."),d[24]="CreateDerivedKeys returned an empty list of keys. This should never happen; aborting dasm VM.",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBCryptoUtils] ","",d[24]].join("")),d[23]=c.createArray(),void 0!==void 0?d[25]=(d[23].push(void 0),d[23]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils",d[24],d[23],c.i64.cast([0,3]))},function(a){return d[22]=void 0}])},function(a){return d[16]=d[22]}]):c.sequence([function(a){return function(a){c.logger(a).mustfix(a)}("[EncryptedBackups][MEBCryptoUtils] CreateDerivedKeys returned null. This should never happen; aborting dasm VM."),d[22]="CreateDerivedKeys returned null. This should never happen; aborting dasm VM.",function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][MEBCryptoUtils] ","",d[22]].join("")),d[21]=c.createArray(),void 0!==void 0?d[23]=(d[21].push(void 0),d[21]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"MEBCryptoUtils",d[22],d[21],c.i64.cast([0,3]))},function(a){return d[16]=void 0}])},function(a){return c.blobs.neq(d[16],void 0)?d[17]=!0:d[17]=!1,d[17]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Attempting to coerce a null value to nonnull."),c["throw"]("LS::assert is failed. Attempting to coerce a null value to nonnull.")),c.nativeOperation(b("LSSymmetricEncryptionCreateDecryptedData.nop"),d[16],c.blob("c3VwcGxlbWVudGFsX2VuY19hYWQ="),d[2]).then(function(a){return a=a,d[18]=a[0],a})},function(a){return c.blobs.neq(d[18],void 0)?(a=[c.blobs.to_string(d[18]),void 0],d[19]=a[0],d[20]=a[1],a):(d[21]=new c.Map(),d[21].set("error_code",c.i64.cast([0,109])),d[21].set("stored_procedure","LSEncryptedBackupsDecryptSupplementalKeyStoredProcedure"),d[21].set("error_message",""),a=[void 0,d[21]],d[19]=a[0],d[20]=a[1]),a=[d[19],d[20]],d[5]=a[0],d[6]=a[1]}]):c.resolve((d[13]=new c.Map(),d[13].set("error_code",c.i64.cast([0,109])),d[13].set("stored_procedure","LSEncryptedBackupsDecryptSupplementalKeyStoredProcedure"),d[13].set("error_message",""),a=[void 0,d[13]],d[5]=a[0],d[6]=a[1]))},function(a){return d[7]=c.i64.of_float(Date.now()),d[8]=c.i64.random(),d[10]="Finishing execution. Execution time: ",d[11]=c.i64.to_string(c.i64.sub(d[7],d[0])),d[12]=" ms",d[9]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][decryptSupplementalKey] ",d[9],d[10],d[9],d[11],d[9],d[12]].join("")),c.i64.eq(c.i64.mod_(d[8],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[13]=",",d[14]=c.createArray(),void 0!==void 0?d[15]=(d[14].push(void 0),d[14]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"decryptSupplementalKey",[d[10],d[13],d[11],d[13],d[12]].join(""),d[14],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[5],d[6]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsDecryptSupplementalKeyStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSDecryptMessageProtobufsV2",["LSArrayGetObjectAt","LSDecryptProtobuf","LSDecryptSupplementalKey","LSIsEncryptionVersionSecure","LSLogMebClientEvent.nop","LSQplAnnotateInt.nop","LSQplMarkEnd.nop","LSQplMarkPoint.nop","LSQplStartTrace.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(f){return c.sequence([function(a){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][decryptMessageProtobufsV2] Beginning execution."),d[1]=c.i64.of_float(Date.now()),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[15]=new c.Map(),d[15].set("error_msg","Expected a nonempty query result"),d[15].set("code",c.i64.cast([0,3])),d[15].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),d[16]=c.createArray(),d[17]=(d[16].push(d[15]),d[16]),e=[void 0,d[16]],d[2]=e[0],d[3]=e[1]):(b=a.item,d[15]=new c.Map(),d[15].set("backup_id",b.backupId),d[15].set("device_public_key_blob",b.devicePublicKeyBlob),d[15].set("device_private_key_blob",b.devicePrivateKeyBlob),d[15].set("epoch_storage_public_key_blob",b.epochStoragePublicKeyBlob),d[15].set("epoch_storage_private_key_blob",b.epochStoragePrivateKeyBlob),d[15].set("epoch_auth_public_key_blob",b.epochAuthPublicKeyBlob),d[15].set("epoch_auth_private_key_blob",b.epochAuthPrivateKeyBlob),d[15].set("mailbox_root_key_blob",b.mailboxRootKeyBlob),d[15].set("ocmf_client_state_blob",b.ocmfClientStateBlob),d[15].set("orf_client_state_v2_blob",void 0),d[15].set("orf_v2_authority_level",void 0),d[15].set("oblivious_validation_token_blob",b.obliviousValidationTokenBlob),d[15].set("device_id",b.deviceId),d[15].set("backup_tenancy",b.backupTenancy),d[15].set("encryption_version",b.encryptionVersion),d[15].set("revision_version",b.revisionVersion),d[15].set("initialize_restore_result",void 0),d[15].set("device_creation_timestamp_sec",void 0),d[15].set("authority_level",b.authorityLevel),e=[d[15],void 0],d[2]=e[0],d[3]=e[1])})},function(e){return d[5]=new c.Map(),d[5].set("value",d[2]),d[5].set("errors",d[3]),d[6]=d[5].get("value"),d[6]!==void 0?c.sequence([function(e){return d[15]=d[6].get("backup_id"),d[16]=d[6].get("device_public_key_blob"),d[17]=d[6].get("device_private_key_blob"),d[18]=d[6].get("epoch_storage_public_key_blob"),d[19]=d[6].get("epoch_storage_private_key_blob"),d[20]=d[6].get("epoch_auth_public_key_blob"),d[21]=d[6].get("epoch_auth_private_key_blob"),d[22]=d[6].get("mailbox_root_key_blob"),d[23]=d[6].get("ocmf_client_state_blob"),d[24]=d[6].get("orf_client_state_v2_blob"),d[25]=d[6].get("orf_v2_authority_level"),d[26]=d[6].get("oblivious_validation_token_blob"),d[27]=d[6].get("device_id"),d[28]=d[6].get("backup_tenancy"),d[29]=d[6].get("encryption_version"),d[30]=d[6].get("revision_version"),d[31]=d[6].get("initialize_restore_result"),d[32]=d[6].get("device_creation_timestamp_sec"),d[33]=d[6].get("authority_level"),c.i64.neq(d[27],void 0)?c.sequence([function(a){return d[36]=void 0,c.i64.neq(d[36],void 0)?c.resolve(d[37]=d[36]):c.sequence([function(a){return d[49]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[50]=a[0],a})},function(a){return d[50]?d[59]=(d[49].push(c.i64.cast([0,0])),d[49]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[51]=a[0],a})},function(a){return d[51]?d[59]=(d[49].push(c.i64.cast([0,2])),d[49]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[52]=a[0],a})},function(a){return d[52]?d[59]=(d[49].push(c.i64.cast([0,3])),d[49]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[53]=a[0],a})},function(a){return d[53]?d[59]=(d[49].push(c.i64.cast([0,4])),d[49]):0,d[54]=c.createArray(),d[55]=c.i64.of_int32(d[49].length),c.i64.gt(d[55],c.i64.cast([0,0]))?c.loopAsync(d[55],function(a){return d[59]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[49],d[59]).then(function(a){return a=a,d[60]=a[0],d[61]=a[1],a})},function(a){return d[62]=(d[54].push(d[60]),d[54])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[59]=c.createArray(),d[60]=c.i64.of_int32(d[54].length),c.i64.gt(d[60],c.i64.cast([0,0]))?c.loopAsync(d[60],function(a){return d[62]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[54],d[62]).then(function(a){return a=a,d[63]=a[0],d[64]=a[1],a})},function(a){return d[65]=(d[59].push(c.i64.to_string(d[63])),d[59])}])}):c.resolve()},function(a){return d[61]=d[59].join(","),d[56]=d[61]}])},function(a){return d[54].some(function(a){return c.i64.eq(d[29],a)})?d[57]=d[29]:d[57]=void 0,c.i64.neq(d[57],void 0)?d[58]=d[57]:d[58]=void 0,d[37]=d[58]}])},function(e){return c.i64.neq(d[37],void 0)?d[38]=d[37]:d[38]=c.i64.cast([0,0]),c.i64.neq(d[28],void 0)?d[39]=d[28]:d[39]=c.i64.cast([0,1]),d[40]=c.createArray(),d[41]=c.createArray(),d[42]=new c.Map(),a[2]!==void 0?d[43]=a[2]:(d[49]=new c.Map(),d[43]=d[49]),d[44]=d[43].keys(),d[45]=c.i64.of_int32(a[0].length),c.i64.gt(d[45],c.i64.cast([0,0]))?c.loopAsync(d[45],function(e){return d[49]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[0],d[49]).then(function(a){return a=a,d[50]=a[0],d[51]=a[1],a})},function(a){return d[52]=d[50].get("encrypted_protobufs_v2"),d[53]=d[52].get("toplevel_protobuf"),d[54]=c.i64.random(),d[61]=c.i64.to_string(d[54]),c.resolve()},function(a){return c.resolve()},function(a){return d[55]=d[50].get("otid"),d[56]=d[52].get("toplevel_protobuf_v2"),c.resolve((d[62]=new c.Map(),d[62].set("error_code",c.i64.cast([0,117])),d[62].set("stored_procedure","LSEncryptedBackupsDecryptMessageProtobufsV2StoredProcedure"),d[62].set("error_message",""),a=[void 0,d[62]],d[57]=a[0],d[58]=a[1]))},function(e){return d[57]!==void 0?c.sequence([function(a){return c.resolve()},function(a){return d[53]!==void 0?c.resolve(0):c.resolve()},function(a){return a=[d[57],d[58]],d[59]=a[0],d[60]=a[1],a}]):c.sequence([function(a){return c.resolve()},function(e){return d[53]!==void 0?c.sequence([function(a){return d[64]=d[53].get("epoch_id"),d[65]=d[53].get("epoch_anon_id"),d[66]=d[42].get(c.blobs.to_string(d[65])),d[66]!==void 0?c.resolve(d[67]=d[66]):c.sequence([function(a){return c.i64.neq(d[64],void 0)?c.sequence([function(a){return d[76]=c.createArray(),c.count(c.db.table(169).fetch([[[d[64]]]])).then(function(a){return d[77]=a})},function(a){return c.i64.le(d[77],c.i64.cast([0,1]))?c.sequence([function(a){return c.db.table(169).fetch([[[d[64]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[87]=new c.Map(),d[87].set("error_msg","Expected a nonempty query result"),d[87].set("code",c.i64.cast([0,3])),d[87].set("src_line","MEBEpochClientUtils.php:313 MEBEpochClientUtils::requireEpochReturnShapeFromPersistentEpochsTableDirectly()"),d[88]=c.createArray(),d[89]=(d[88].push(d[87]),d[88]),e=[void 0,d[88]],d[83]=e[0],d[84]=e[1]):(b=a.item,d[87]=new c.Map(),d[87].set("epoch_id",b.epochId),d[87].set("backup_id",b.backupId),d[87].set("epoch_anon_id_blob",b.epochAnonIdBlob),d[87].set("epoch_root_key_blob",b.epochRootKeyBlob),d[87].set("epoch_status",b.epochStatus),d[87].set("epoch_head",b.epochHead),d[87].set("authority_level",b.authorityLevel),e=[d[87],void 0],d[83]=e[0],d[84]=e[1])})},function(a){return d[86]=new c.Map(),d[86].set("value",d[83]),d[86].set("errors",d[84]),d[78]=d[86]}]):c.resolve((d[83]=new c.Map(),d[83].set("error_msg","Expected at most one result"),d[83].set("code",c.i64.cast([0,4])),d[83].set("src_line","MEBEpochClientUtils.php:313 MEBEpochClientUtils::requireEpochReturnShapeFromPersistentEpochsTableDirectly()"),d[84]=c.createArray(),d[86]=(d[84].push(d[83]),d[84]),d[85]=new c.Map(),d[85].set("value",void 0),d[85].set("errors",d[84]),d[78]=d[85]))},function(a){return d[79]=d[78].get("value"),d[79]!==void 0?(d[83]=d[79].get("epoch_id"),d[84]=d[79].get("backup_id"),d[85]=d[79].get("epoch_anon_id_blob"),d[86]=d[79].get("epoch_root_key_blob"),d[87]=d[79].get("epoch_status"),d[88]=d[79].get("epoch_head"),d[89]=d[79].get("authority_level"),c.i64.eq(d[89],c.i64.cast([0,80]))?d[90]=d[78]:(d[91]=new c.Map(),d[91].set("error_msg","NONE"),d[91].set("code",c.i64.cast([0,0])),d[91].set("src_line","MEBEpochClientUtils.php:315 Closure$MEBEpochClientUtils::requireEpochReturnShapeFromPersistentEpochsTableDirectly#2()"),d[92]=c.createArray(),d[94]=(d[92].push(d[91]),d[92]),d[93]=new c.Map(),d[93].set("value",void 0),d[93].set("errors",d[92]),d[90]=d[93]),d[80]=d[90]):(d[83]=d[78].get("errors"),d[84]=d[78].get("errors"),d[85]=new c.Map(),d[85].set("value",void 0),d[85].set("errors",d[83]),d[80]=d[85]),d[81]=d[80].get("value"),d[81]!==void 0?(d[83]=d[81].get("epoch_id"),d[84]=d[81].get("backup_id"),d[85]=d[81].get("epoch_anon_id_blob"),d[86]=d[81].get("epoch_root_key_blob"),d[87]=d[81].get("epoch_status"),d[88]=d[81].get("epoch_head"),d[89]=d[81].get("authority_level"),c.i64.eq(d[84],d[15])&&c.i64.eq(d[89],c.i64.cast([0,80]))?(d[90]=new c.Map(),d[90].set("epoch_root_key",d[86]),d[90].set("epoch_anon_id",d[85]),d[91]=(d[76].push(d[90]),d[76])):0,d[82]=!0):(d[83]=d[80].get("errors"),d[84]=d[80].get("errors"),d[82]=!1),d[75]=d[76]}]):c.sequence([function(a){return d[76]=c.createArray(),c.filter(c.db.table(169).fetch(),function(a){return c.blobs.eq(a.epochAnonIdBlob,d[65])}).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[83]=new c.Map(),d[83].set("error_msg","Expected a nonempty query result"),d[83].set("code",c.i64.cast([0,3])),d[83].set("src_line","MEBEpochClientUtils.php:556 MEBEpochClientUtils::maybeEpochWithAnonIDFromPersistentEpochsTableDirectly()"),d[84]=c.createArray(),d[85]=(d[84].push(d[83]),d[84]),e=[void 0,d[84]],d[77]=e[0],d[78]=e[1]):(b=a.item,d[83]=new c.Map(),d[83].set("epoch_id",b.epochId),d[83].set("backup_id",b.backupId),d[83].set("epoch_anon_id_blob",b.epochAnonIdBlob),d[83].set("epoch_root_key_blob",b.epochRootKeyBlob),d[83].set("epoch_status",b.epochStatus),d[83].set("epoch_head",b.epochHead),d[83].set("authority_level",b.authorityLevel),e=[d[83],void 0],d[77]=e[0],d[78]=e[1])})},function(a){return d[80]=new c.Map(),d[80].set("value",d[77]),d[80].set("errors",d[78]),d[81]=d[80].get("value"),d[81]!==void 0?(d[83]=d[81].get("epoch_id"),d[84]=d[81].get("backup_id"),d[85]=d[81].get("epoch_anon_id_blob"),d[86]=d[81].get("epoch_root_key_blob"),d[87]=d[81].get("epoch_status"),d[88]=d[81].get("epoch_head"),d[89]=d[81].get("authority_level"),c.i64.eq(d[84],d[15])&&c.i64.eq(d[89],c.i64.cast([0,80]))?(d[90]=new c.Map(),d[90].set("epoch_root_key",d[86]),d[90].set("epoch_anon_id",d[85]),d[91]=(d[76].push(d[90]),d[76])):0,d[82]=!0):(d[83]=d[80].get("errors"),d[84]=d[80].get("errors"),d[82]=!1),d[75]=d[76]}])},function(a){return d[67]=d[75]}])},function(e){return d[68]=d[53].get("epoch_anon_id"),d[42].set(c.blobs.to_string(d[68]),d[67]),d[69]=d[53].get("encrypted_protobuf"),d[70]=d[53].get("encryption_version"),c.storedProcedure(b("LSDecryptProtobuf"),d[69],d[70],a[1],d[67]).then(function(a){return a=a,d[71]=a[0],d[72]=a[1],a})},function(a){return c.blobs.neq(d[71],void 0)?(d[75]=d[53].get("protobuf_timestamp_ms"),d[76]=new c.Map(),d[76].set("decrypted_protobuf",d[71]),d[76].set("protobuf_timestamp_ms",d[75]),a=[d[76],void 0],d[73]=a[0],d[74]=a[1]):(a=[void 0,d[72]],d[73]=a[0],d[74]=a[1],a),a=[d[73],d[74]],d[62]=a[0],d[63]=a[1]}]):c.sequence([function(a){return c.resolve()},function(a){return d[64]=new c.Map(),d[64].set("error_code",c.i64.cast([0,116])),d[64].set("stored_procedure","LSEncryptedBackupsDecryptMessageProtobufsV2StoredProcedure"),d[64].set("error_message",""),a=[void 0,d[64]],d[62]=a[0],d[63]=a[1]}])},function(a){return a=[d[62],d[63]],d[59]=a[0],d[60]=a[1],a}])},function(e){return d[59]!==void 0?c.sequence([function(a){return d[62]=d[52].get("supplemental_protobufs"),d[63]=d[52].get("supplemental_protobufs_v2"),d[64]=d[50].get("otid"),d[65]=new c.Map(),d[66]=c.createArray(),c.resolve()},function(e){return d[67]=d[65].keys(),d[68]=d[62].keys(),d[69]=c.i64.of_int32(d[68].length),c.i64.gt(d[69],c.i64.cast([0,0]))?c.loopAsync(d[69],function(e){return d[75]=e,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[68],d[75]).then(function(a){return a=a,d[76]=a[0],d[77]=a[1],a})},function(e){return d[78]=d[62].get(d[76]),d[78]!==void 0?c.sequence([function(a){return d[79]=d[78].get("supplemental_otid"),d[79]!==void 0?c.sequence([function(a){return d[81]=!1,d[82]=c.i64.of_int32(d[66].length),c.i64.gt(d[82],c.i64.cast([0,0]))?c.loopAsync(d[82],function(a){return d[83]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[66],d[83]).then(function(a){return a=a,d[84]=a[0],d[85]=a[1],a})},function(a){return d[81]=d[81]||d[79]===d[84]}])}):c.resolve()},function(a){return d[80]=!d[81]}]):c.resolve(d[80]=!0)},function(e){return d[80]?c.sequence([function(a){return d[81]=d[78].get("epoch_id"),d[82]=d[78].get("epoch_anon_id"),d[83]=d[42].get(c.blobs.to_string(d[82])),d[83]!==void 0?c.resolve(d[84]=d[83]):c.sequence([function(a){return c.i64.neq(d[81],void 0)?c.sequence([function(a){return d[90]=c.createArray(),c.count(c.db.table(169).fetch([[[d[81]]]])).then(function(a){return d[91]=a})},function(a){return c.i64.le(d[91],c.i64.cast([0,1]))?c.sequence([function(a){return c.db.table(169).fetch([[[d[81]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[101]=new c.Map(),d[101].set("error_msg","Expected a nonempty query result"),d[101].set("code",c.i64.cast([0,3])),d[101].set("src_line","MEBEpochClientUtils.php:313 MEBEpochClientUtils::requireEpochReturnShapeFromPersistentEpochsTableDirectly()"),d[102]=c.createArray(),d[103]=(d[102].push(d[101]),d[102]),e=[void 0,d[102]],d[97]=e[0],d[98]=e[1]):(b=a.item,d[101]=new c.Map(),d[101].set("epoch_id",b.epochId),d[101].set("backup_id",b.backupId),d[101].set("epoch_anon_id_blob",b.epochAnonIdBlob),d[101].set("epoch_root_key_blob",b.epochRootKeyBlob),d[101].set("epoch_status",b.epochStatus),d[101].set("epoch_head",b.epochHead),d[101].set("authority_level",b.authorityLevel),e=[d[101],void 0],d[97]=e[0],d[98]=e[1])})},function(a){return d[100]=new c.Map(),d[100].set("value",d[97]),d[100].set("errors",d[98]),d[92]=d[100]}]):c.resolve((d[97]=new c.Map(),d[97].set("error_msg","Expected at most one result"),d[97].set("code",c.i64.cast([0,4])),d[97].set("src_line","MEBEpochClientUtils.php:313 MEBEpochClientUtils::requireEpochReturnShapeFromPersistentEpochsTableDirectly()"),d[98]=c.createArray(),d[100]=(d[98].push(d[97]),d[98]),d[99]=new c.Map(),d[99].set("value",void 0),d[99].set("errors",d[98]),d[92]=d[99]))},function(a){return d[93]=d[92].get("value"),d[93]!==void 0?(d[97]=d[93].get("epoch_id"),d[98]=d[93].get("backup_id"),d[99]=d[93].get("epoch_anon_id_blob"),d[100]=d[93].get("epoch_root_key_blob"),d[101]=d[93].get("epoch_status"),d[102]=d[93].get("epoch_head"),d[103]=d[93].get("authority_level"),c.i64.eq(d[103],c.i64.cast([0,80]))?d[104]=d[92]:(d[105]=new c.Map(),d[105].set("error_msg","NONE"),d[105].set("code",c.i64.cast([0,0])),d[105].set("src_line","MEBEpochClientUtils.php:315 Closure$MEBEpochClientUtils::requireEpochReturnShapeFromPersistentEpochsTableDirectly#2()"),d[106]=c.createArray(),d[108]=(d[106].push(d[105]),d[106]),d[107]=new c.Map(),d[107].set("value",void 0),d[107].set("errors",d[106]),d[104]=d[107]),d[94]=d[104]):(d[97]=d[92].get("errors"),d[98]=d[92].get("errors"),d[99]=new c.Map(),d[99].set("value",void 0),d[99].set("errors",d[97]),d[94]=d[99]),d[95]=d[94].get("value"),d[95]!==void 0?(d[97]=d[95].get("epoch_id"),d[98]=d[95].get("backup_id"),d[99]=d[95].get("epoch_anon_id_blob"),d[100]=d[95].get("epoch_root_key_blob"),d[101]=d[95].get("epoch_status"),d[102]=d[95].get("epoch_head"),d[103]=d[95].get("authority_level"),c.i64.eq(d[98],d[15])&&c.i64.eq(d[103],c.i64.cast([0,80]))?(d[104]=new c.Map(),d[104].set("epoch_root_key",d[100]),d[104].set("epoch_anon_id",d[99]),d[105]=(d[90].push(d[104]),d[90])):0,d[96]=!0):(d[97]=d[94].get("errors"),d[98]=d[94].get("errors"),d[96]=!1),d[89]=d[90]}]):c.sequence([function(a){return d[90]=c.createArray(),c.filter(c.db.table(169).fetch(),function(a){return c.blobs.eq(a.epochAnonIdBlob,d[82])}).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[97]=new c.Map(),d[97].set("error_msg","Expected a nonempty query result"),d[97].set("code",c.i64.cast([0,3])),d[97].set("src_line","MEBEpochClientUtils.php:556 MEBEpochClientUtils::maybeEpochWithAnonIDFromPersistentEpochsTableDirectly()"),d[98]=c.createArray(),d[99]=(d[98].push(d[97]),d[98]),e=[void 0,d[98]],d[91]=e[0],d[92]=e[1]):(b=a.item,d[97]=new c.Map(),d[97].set("epoch_id",b.epochId),d[97].set("backup_id",b.backupId),d[97].set("epoch_anon_id_blob",b.epochAnonIdBlob),d[97].set("epoch_root_key_blob",b.epochRootKeyBlob),d[97].set("epoch_status",b.epochStatus),d[97].set("epoch_head",b.epochHead),d[97].set("authority_level",b.authorityLevel),e=[d[97],void 0],d[91]=e[0],d[92]=e[1])})},function(a){return d[94]=new c.Map(),d[94].set("value",d[91]),d[94].set("errors",d[92]),d[95]=d[94].get("value"),d[95]!==void 0?(d[97]=d[95].get("epoch_id"),d[98]=d[95].get("backup_id"),d[99]=d[95].get("epoch_anon_id_blob"),d[100]=d[95].get("epoch_root_key_blob"),d[101]=d[95].get("epoch_status"),d[102]=d[95].get("epoch_head"),d[103]=d[95].get("authority_level"),c.i64.eq(d[98],d[15])&&c.i64.eq(d[103],c.i64.cast([0,80]))?(d[104]=new c.Map(),d[104].set("epoch_root_key",d[100]),d[104].set("epoch_anon_id",d[99]),d[105]=(d[90].push(d[104]),d[90])):0,d[96]=!0):(d[97]=d[94].get("errors"),d[98]=d[94].get("errors"),d[96]=!1),d[89]=d[90]}])},function(a){return d[84]=d[89]}])},function(a){return d[85]=d[78].get("epoch_anon_id"),d[42].set(c.blobs.to_string(d[85]),d[84]),d[86]=d[78].get("sk_ciphertext"),c.storedProcedure(b("LSDecryptSupplementalKey"),d[86]==null?"":d[86],d[84]).then(function(a){return a=a,d[87]=a[0],d[88]=a[1],a})},function(e){return d[87]!==void 0?c.sequence([function(a){return d[89]=!1,d[90]=c.i64.of_int32(d[67].length),c.i64.gt(d[90],c.i64.cast([0,0]))?c.loopAsync(d[90],function(a){return d[91]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[67],d[91]).then(function(a){return a=a,d[92]=a[0],d[93]=a[1],a})},function(a){return d[89]=d[89]||d[87]===d[92]}])}):c.resolve()},function(e){return d[89]?c.resolve():c.sequence([function(e){return d[91]=d[78].get("encrypted_protobuf"),d[92]=d[78].get("encryption_version"),c.storedProcedure(b("LSDecryptProtobuf"),d[91],d[92],a[1],d[84]).then(function(a){return a=a,d[93]=a[0],d[94]=a[1],a})},function(a){return c.blobs.neq(d[93],void 0)?(d[95]=d[78].get("protobuf_timestamp_ms"),d[96]=new c.Map(),d[96].set("decrypted_protobuf",d[93]),d[96].set("protobuf_timestamp_ms",d[95]),d[65].set(d[87],d[96])):d[95]=(d[41].push(d[94]),d[41])}])}]):c.resolve((d[89]=new c.Map(),d[89].set("error_code",c.i64.cast([0,109])),d[89].set("stored_procedure","LSEncryptedBackupsDecryptMessageProtobufsV2StoredProcedure"),d[89].set("error_message",""),d[90]=(d[41].push(d[89]),d[41])))}]):c.resolve()}]):(d[79]=["Supplemental key is null for supplemental protobuf with otid: ",d[64]," act_thread_id: ",a[1]].join(""),function(a){c.logger(a).mustfix(a)}(["[EncryptedBackups][decryptMessageProtobufsV2] ","",d[79]].join("")),d[80]=c.createArray(),void 0!==void 0?d[81]=(d[80].push(void 0),d[80]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"decryptMessageProtobufsV2",[d[79]].join(""),d[80],c.i64.cast([0,3])))}])}):c.resolve()},function(a){return d[70]=d[50].get("otid"),d[71]=d[50].get("message_tags"),d[72]=d[50].get("attachment_data"),d[72]!==void 0?c.sequence([function(a){return d[75]=c.createArray(),d[76]=c.i64.of_int32(d[72].length),c.i64.gt(d[76],c.i64.cast([0,0]))?c.loopAsync(d[76],function(a){return d[79]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[72],d[79]).then(function(a){return a=a,d[80]=a[0],d[81]=a[1],a})},function(a){return d[82]=(d[75].push(d[80]),d[75])}])}):c.resolve()},function(a){return d[77]=new c.Map(),d[77].set("attachment_data",d[75]),d[78]=c.toJSON(d[77]),d[73]=d[78]}]):c.resolve(d[73]=void 0)},function(a){return d[74]=new c.Map(),d[74].set("otid",d[70]),d[74].set("toplevel_protobuf",d[59]),d[74].set("supplemental_protobufs",d[65]),d[74].set("message_tags",d[71]),d[74].set("restore_message_data",d[73]),d[75]=(d[40].push(d[74]),d[40]),c.resolve()}]):(d[62]=(d[41].push(d[60]),d[41]),c.resolve())}])}):c.resolve()},function(a){return d[46]=c.i64.of_int32(d[41].length),c.i64.gt(d[46],c.i64.cast([0,0]))?c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[41],c.i64.cast([0,0])).then(function(a){return a=a,d[49]=a[0],d[50]=a[1],a})},function(a){return a=[void 0,d[49]],d[47]=a[0],d[48]=a[1],a}]):c.resolve((a=[d[40],void 0],d[47]=a[0],d[48]=a[1],a))},function(a){return a=[d[47],d[48]],d[34]=a[0],d[35]=a[1],a}]):c.resolve((d[36]=new c.Map(),d[36].set("error_code",c.i64.cast([0,24])),d[36].set("stored_procedure","LSEncryptedBackupsDecryptMessageProtobufsV2StoredProcedure"),d[36].set("error_message",""),e=[void 0,d[36]],d[34]=e[0],d[35]=e[1]))},function(a){return a=[d[34],d[35]],d[7]=a[0],d[8]=a[1],a}]):c.resolve((d[15]=d[5].get("errors"),d[16]=d[5].get("errors"),d[17]=new c.Map(),d[17].set("error_code",c.i64.cast([0,1])),d[17].set("stored_procedure","LSEncryptedBackupsDecryptMessageProtobufsV2StoredProcedure"),d[17].set("error_message",""),e=[void 0,d[17]],d[7]=e[0],d[8]=e[1]))},function(a){return d[9]=c.i64.of_float(Date.now()),d[10]=c.i64.random(),d[12]="Finishing execution. Execution time: ",d[13]=c.i64.to_string(c.i64.sub(d[9],d[0])),d[14]=" ms",d[11]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][decryptMessageProtobufsV2] ",d[11],d[12],d[11],d[13],d[11],d[14]].join("")),c.i64.eq(c.i64.mod_(d[10],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[15]=",",d[16]=c.createArray(),void 0!==void 0?d[17]=(d[16].push(void 0),d[16]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"decryptMessageProtobufsV2",[d[12],d[15],d[13],d[15],d[14]].join(""),d[16],c.i64.cast([0,4]))):c.resolve()},function(a){return a=[d[7],d[8]],e[0]=a[0],e[1]=a[1],a}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsDecryptMessageProtobufsV2StoredProcedure";a.__tables__=["secure_encrypted_backups_client_state","secure_encrypted_backups_epochs"];e.exports=a}),null);
__d("LSHandleMessageWithProtobufsRestoreV2",["LSArrayGetObjectAt","LSDecryptMessageProtobufsV2","LSDeserializeFromJsonIntoDictionaryV2.nop","LSIsEncryptionVersionSecure","LSLoadThreadPkFromThreadId","LSLogMebClientEvent.nop","LSLogWebQpl.nop","LSQplAnnotateString.nop","LSQplMarkEnd.nop","LSQplMarkPoint.nop","LSQplStartTrace.nop","LSRestoreProtobufs.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return d[0]=c.i64.of_float(Date.now()),function(a){c.logger(a).info(a)}("[EncryptedBackups][handleMessageWithProtobufsRestoreV2] Beginning execution."),d[1]=c.i64.of_float(Date.now()),d[2]=a[5].get("restore_task_source"),a[9]!==void 0?c.nativeOperation(b("LSQplStartTrace.nop"),c.i64.cast([0,679687866]),a[9],!0,void 0):c.resolve()},function(e){return d[3]=c.i64.of_int32(a[0].length),c.i64.eq(d[3],c.i64.cast([0,0]))?c.sequence([function(d){return a[9]!==void 0?c.nativeOperation(b("LSQplMarkPoint.nop"),c.i64.cast([0,679687866]),a[9],"maybe_populate_sender_device_keys_called"):c.resolve()},function(d){return a[9]!==void 0?c.nativeOperation(b("LSQplMarkPoint.nop"),c.i64.cast([0,679687866]),a[9],"minos_sender_device_keys_table_null"):c.resolve()}]):c.resolve()},function(e){return c.storedProcedure(b("LSDecryptMessageProtobufsV2"),a[0],a[2],a[10]).then(function(a){return a=a,d[4]=a[0],d[5]=a[1],a})},function(e){return d[6]=a[5].get("request_id"),d[7]=c.i64.of_int32(a[0].length),d[6]!==void 0?c.nativeOperation(b("LSLogWebQpl.nop"),d[6],c.i64.cast([0,521476165]),"call_from_client",d[7],void 0,void 0):c.resolve()},function(e){return c.i64.neq(a[7],void 0)?c.sequence([function(a){return c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[21]=new c.Map(),d[21].set("error_msg","Expected a nonempty query result"),d[21].set("code",c.i64.cast([0,3])),d[21].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),d[22]=c.createArray(),d[23]=(d[22].push(d[21]),d[22]),e=[void 0,d[22]],d[15]=e[0],d[16]=e[1]):(b=a.item,d[21]=new c.Map(),d[21].set("backup_id",b.backupId),d[21].set("device_public_key_blob",b.devicePublicKeyBlob),d[21].set("device_private_key_blob",b.devicePrivateKeyBlob),d[21].set("epoch_storage_public_key_blob",b.epochStoragePublicKeyBlob),d[21].set("epoch_storage_private_key_blob",b.epochStoragePrivateKeyBlob),d[21].set("epoch_auth_public_key_blob",b.epochAuthPublicKeyBlob),d[21].set("epoch_auth_private_key_blob",b.epochAuthPrivateKeyBlob),d[21].set("mailbox_root_key_blob",b.mailboxRootKeyBlob),d[21].set("ocmf_client_state_blob",b.ocmfClientStateBlob),d[21].set("orf_client_state_v2_blob",void 0),d[21].set("orf_v2_authority_level",void 0),d[21].set("oblivious_validation_token_blob",b.obliviousValidationTokenBlob),d[21].set("device_id",b.deviceId),d[21].set("backup_tenancy",b.backupTenancy),d[21].set("encryption_version",b.encryptionVersion),d[21].set("revision_version",b.revisionVersion),d[21].set("initialize_restore_result",void 0),d[21].set("device_creation_timestamp_sec",void 0),d[21].set("authority_level",b.authorityLevel),e=[d[21],void 0],d[15]=e[0],d[16]=e[1])})},function(e){return d[18]=new c.Map(),d[18].set("value",d[15]),d[18].set("errors",d[16]),d[19]=d[18].get("value"),d[19]!==void 0?c.sequence([function(e){return d[21]=d[19].get("backup_id"),d[22]=d[19].get("device_public_key_blob"),d[23]=d[19].get("device_private_key_blob"),d[24]=d[19].get("epoch_storage_public_key_blob"),d[25]=d[19].get("epoch_storage_private_key_blob"),d[26]=d[19].get("epoch_auth_public_key_blob"),d[27]=d[19].get("epoch_auth_private_key_blob"),d[28]=d[19].get("mailbox_root_key_blob"),d[29]=d[19].get("ocmf_client_state_blob"),d[30]=d[19].get("orf_client_state_v2_blob"),d[31]=d[19].get("orf_v2_authority_level"),d[32]=d[19].get("oblivious_validation_token_blob"),d[33]=d[19].get("device_id"),d[34]=d[19].get("backup_tenancy"),d[35]=d[19].get("encryption_version"),d[36]=d[19].get("revision_version"),d[37]=d[19].get("initialize_restore_result"),d[38]=d[19].get("device_creation_timestamp_sec"),d[39]=d[19].get("authority_level"),c.i64.neq(d[33],void 0)?c.sequence([function(a){return d[41]=void 0,c.i64.neq(d[41],void 0)?c.resolve(d[42]=d[41]):c.sequence([function(a){return d[45]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[46]=a[0],a})},function(a){return d[46]?d[55]=(d[45].push(c.i64.cast([0,0])),d[45]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[47]=a[0],a})},function(a){return d[47]?d[55]=(d[45].push(c.i64.cast([0,2])),d[45]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[48]=a[0],a})},function(a){return d[48]?d[55]=(d[45].push(c.i64.cast([0,3])),d[45]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[49]=a[0],a})},function(a){return d[49]?d[55]=(d[45].push(c.i64.cast([0,4])),d[45]):0,d[50]=c.createArray(),d[51]=c.i64.of_int32(d[45].length),c.i64.gt(d[51],c.i64.cast([0,0]))?c.loopAsync(d[51],function(a){return d[55]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[45],d[55]).then(function(a){return a=a,d[56]=a[0],d[57]=a[1],a})},function(a){return d[58]=(d[50].push(d[56]),d[50])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[55]=c.createArray(),d[56]=c.i64.of_int32(d[50].length),c.i64.gt(d[56],c.i64.cast([0,0]))?c.loopAsync(d[56],function(a){return d[58]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[50],d[58]).then(function(a){return a=a,d[59]=a[0],d[60]=a[1],a})},function(a){return d[61]=(d[55].push(c.i64.to_string(d[59])),d[55])}])}):c.resolve()},function(a){return d[57]=d[55].join(","),d[52]=d[57]}])},function(a){return d[50].some(function(a){return c.i64.eq(d[35],a)})?d[53]=d[35]:d[53]=void 0,c.i64.neq(d[53],void 0)?d[54]=d[53]:d[54]=void 0,d[42]=d[54]}])},function(b){return c.i64.neq(d[42],void 0)?d[43]=d[42]:d[43]=c.i64.cast([0,0]),c.i64.neq(d[34],void 0)?d[44]=d[34]:d[44]=c.i64.cast([0,1]),d[40]=c.i64.neq(d[33],a[7])}]):c.resolve(d[40]=!1)},function(a){return d[20]=d[40]}]):c.resolve((d[21]=d[18].get("errors"),d[22]=d[18].get("errors"),d[20]=!1))},function(a){return d[8]=d[20]}]):c.resolve(d[8]=!1)},function(e){return d[8]?c.sequence([function(e){return d[15]=new c.Map(),d[15].set("error_code",c.i64.cast([0,110])),d[15].set("stored_procedure","LSEncryptedBackupsHandleMessageWithProtobufsRestoreV2StoredProcedure"),d[15].set("error_message",""),c.storedProcedure(b("LSLoadThreadPkFromThreadId"),a[2]).then(function(a){return a=a,d[16]=a[0],d[17]=a[1],a})},function(e){return d[18]=new c.Map(),d[18].set("error_code",c.i64.cast([0,110])),d[18].set("stored_procedure","LSEncryptedBackupsHandleMessageWithProtobufsRestoreV2StoredProcedure"),d[18].set("error_message",""),a[9]!==void 0?c.nativeOperation(b("LSQplMarkPoint.nop"),c.i64.cast([0,679677570]),a[9],"handle_restore_response"):c.resolve()},function(d){return a[9]!==void 0?c.nativeOperation(b("LSQplMarkEnd.nop"),c.i64.cast([0,679677570]),a[9],!1):c.resolve()},function(e){return d[18]!==void 0?(d[21]=d[18].get("error_code"),d[19]=["LSEBPayloadSerializerError","_",c.i64.to_string(d[21])].join("")):d[19]="unknown_failure",d[20]=["LSEncryptedBackupsHandleMessageWithProtobufsRestoreV2StoredProcedure",".",d[19]].join(""),a[9]!==void 0?d[20]!==void 0?c.nativeOperation(b("LSQplAnnotateString.nop"),c.i64.cast([0,679687866]),a[9],"error",d[20]):c.resolve():c.resolve()},function(d){return a[9]!==void 0?c.nativeOperation(b("LSQplMarkEnd.nop"),c.i64.cast([0,679687866]),a[9],!1):c.resolve()}]):c.sequence([function(e){return d[4]!==void 0?c.sequence([function(e){return c.storedProcedure(b("LSLoadThreadPkFromThreadId"),a[2]).then(function(a){return a=a,d[17]=a[0],d[18]=a[1],a})},function(e){return c.i64.neq(d[17],void 0)?c.sequence([function(e){return void 0!==void 0?c.resolve((d[23]=c.createArray(),e=[d[23],void 0],d[21]=e[0],d[22]=e[1])):c.sequence([function(e){return d[23]=a[1].get("has_more_before"),d[24]=a[1].get("has_more_after"),d[23]?(d[34]=a[1].get("next_message_timestamp_ms_before"),d[25]=d[34]):d[25]=void 0,d[24]?(d[34]=a[1].get("next_message_timestamp_ms_after"),d[26]=d[34]):d[26]=void 0,d[27]=a[1].get("has_more_before"),d[28]=a[1].get("has_more_after"),d[29]=a[5].get("request_id"),d[30]=a[5].get("reference_timestamp"),d[31]=c.createArray(),d[32]=a[1].get("max_content_timestamp_ms"),c.nativeOperation(b("LSRestoreProtobufs.nop"),a[2],d[4],d[27],d[25],d[28],d[26],a[4],d[29],d[30],a[6],d[31],d[2],void 0,a[8],d[32])},function(e){return void 0!==void 0?d[33]=void 0:(d[34]=c.createArray(),d[33]=d[34]),c.i64.eq(d[2],c.i64.cast([0,77]))?(d[34]=c.i64.of_int32(a[0].length),c.i64.gt(d[34],c.i64.cast([0,0]))?c.loopAsync(d[34],function(e){return d[35]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[0],d[35]).then(function(a){return a=a,d[36]=a[0],d[37]=a[1],a})},function(e){return d[38]=d[36].get("encrypted_protobufs_v2"),d[39]=d[38].get("toplevel_protobuf_v2"),d[39]?d[40]=!1:d[40]=!0,d[40]?c.sequence([function(e){return d[49]=d[36].get("otid"),a[9]!==void 0?c.nativeOperation(b("LSQplMarkPoint.nop"),c.i64.cast([0,679687866]),a[9],"maybe_populate_sender_device_keys_called"):c.resolve()},function(d){return a[9]!==void 0?c.nativeOperation(b("LSQplMarkPoint.nop"),c.i64.cast([0,679687866]),a[9],"minos_sender_device_keys_table_null"):c.resolve()}]):c.sequence([function(e){return d[49]=d[36].get("otid"),d[50]=d[39].get("transport_sender_signing_pk"),a[9]!==void 0?c.nativeOperation(b("LSQplMarkPoint.nop"),c.i64.cast([0,679687866]),a[9],"maybe_populate_sender_device_keys_called"):c.resolve()},function(d){return a[9]!==void 0?c.nativeOperation(b("LSQplMarkPoint.nop"),c.i64.cast([0,679687866]),a[9],"minos_sender_device_keys_table_null"):c.resolve()}])},function(e){return d[41]=d[36].get("encrypted_protobufs_v2"),d[42]=d[41].get("supplemental_protobufs_v2"),d[43]=d[42].keys(),d[44]=c.i64.of_int32(d[43].length),c.i64.gt(d[44],c.i64.cast([0,0]))?c.loopAsync(d[44],function(e){return d[49]=e,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[43],d[49]).then(function(a){return a=a,d[50]=a[0],d[51]=a[1],a})},function(e){return d[52]=d[42].get(d[50]),d[52]!==void 0?c.sequence([function(e){return d[53]=d[52].get("supplemental_otid"),d[54]=d[52].get("transport_sender_signing_pk"),d[55]=d[36].get("otid"),a[9]!==void 0?c.nativeOperation(b("LSQplMarkPoint.nop"),c.i64.cast([0,679687866]),a[9],"maybe_populate_sender_device_keys_called"):c.resolve()},function(d){return a[9]!==void 0?c.nativeOperation(b("LSQplMarkPoint.nop"),c.i64.cast([0,679687866]),a[9],"minos_sender_device_keys_table_null"):c.resolve()}]):c.resolve()}])}):c.resolve()},function(e){return d[45]=d[36].get("encrypted_protobufs_v2"),d[46]=d[45].get("supplemental_protobufs"),d[47]=d[46].keys(),d[48]=c.i64.of_int32(d[47].length),c.i64.gt(d[48],c.i64.cast([0,0]))?c.loopAsync(d[48],function(e){return d[49]=e,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[47],d[49]).then(function(a){return a=a,d[50]=a[0],d[51]=a[1],a})},function(e){return d[52]=d[46].get(d[50]),d[52]!==void 0?c.sequence([function(e){return d[53]=d[52].get("supplemental_otid"),d[54]=d[36].get("otid"),a[9]!==void 0?c.nativeOperation(b("LSQplMarkPoint.nop"),c.i64.cast([0,679687866]),a[9],"maybe_populate_sender_device_keys_called"):c.resolve()},function(d){return a[9]!==void 0?c.nativeOperation(b("LSQplMarkPoint.nop"),c.i64.cast([0,679687866]),a[9],"minos_sender_device_keys_table_null"):c.resolve()}]):c.resolve()}])}):c.resolve()}])}):c.resolve()):c.resolve()},function(a){return a=[d[33],void 0],d[21]=a[0],d[22]=a[1],a}])},function(a){return a=[d[21],d[22]],d[19]=a[0],d[20]=a[1],a}]):c.resolve((d[21]=c.createArray(),e=[d[21],d[18]],d[19]=e[0],d[20]=e[1]))},function(a){return a=[d[19],d[20]],d[15]=a[0],d[16]=a[1],a}]):c.sequence([function(e){return d[5]!==void 0?(d[18]=d[5].get("error_code"),c.i64.eq(d[18],c.i64.cast([0,1]))?0:0):0,a[9]!==void 0?c.nativeOperation(b("LSQplMarkPoint.nop"),c.i64.cast([0,679687866]),a[9],"maybe_populate_sender_device_keys_called"):c.resolve()},function(d){return a[9]!==void 0?c.nativeOperation(b("LSQplMarkPoint.nop"),c.i64.cast([0,679687866]),a[9],"minos_sender_device_keys_table_null"):c.resolve()},function(a){return d[17]=c.createArray(),a=[d[17],d[5]],d[15]=a[0],d[16]=a[1]}])},function(e){return d[16]!==void 0?c.sequence([function(e){return c.storedProcedure(b("LSLoadThreadPkFromThreadId"),a[2]).then(function(a){return a=a,d[17]=a[0],d[18]=a[1],a})},function(d){return a[9]!==void 0?c.nativeOperation(b("LSQplMarkPoint.nop"),c.i64.cast([0,679677570]),a[9],"handle_restore_response"):c.resolve()},function(d){return a[9]!==void 0?c.nativeOperation(b("LSQplMarkEnd.nop"),c.i64.cast([0,679677570]),a[9],!1):c.resolve()},function(e){return a[6]!==void 0?c.sequence([function(b){return d[19]=a[5].get("request_id"),c.islc(c.filter(c.db.table(168).fetch(),function(a){return c.i64.eq(a.authorityLevel,c.i64.cast([0,80]))||!1}),0,c.i64.to_float(c.i64.cast([0,1]))).next().then(function(a,b){var e=a.done;a=a.value;return e?(d[41]=new c.Map(),d[41].set("error_msg","Expected a nonempty query result"),d[41].set("code",c.i64.cast([0,3])),d[41].set("src_line","MEBClientStateUtils.php:256 MEBClientStateUtils::maybeClientStateFromDatabaseDirectly()"),d[42]=c.createArray(),d[43]=(d[42].push(d[41]),d[42]),e=[void 0,d[42]],d[20]=e[0],d[21]=e[1]):(b=a.item,d[41]=new c.Map(),d[41].set("backup_id",b.backupId),d[41].set("device_public_key_blob",b.devicePublicKeyBlob),d[41].set("device_private_key_blob",b.devicePrivateKeyBlob),d[41].set("epoch_storage_public_key_blob",b.epochStoragePublicKeyBlob),d[41].set("epoch_storage_private_key_blob",b.epochStoragePrivateKeyBlob),d[41].set("epoch_auth_public_key_blob",b.epochAuthPublicKeyBlob),d[41].set("epoch_auth_private_key_blob",b.epochAuthPrivateKeyBlob),d[41].set("mailbox_root_key_blob",b.mailboxRootKeyBlob),d[41].set("ocmf_client_state_blob",b.ocmfClientStateBlob),d[41].set("orf_client_state_v2_blob",void 0),d[41].set("orf_v2_authority_level",void 0),d[41].set("oblivious_validation_token_blob",b.obliviousValidationTokenBlob),d[41].set("device_id",b.deviceId),d[41].set("backup_tenancy",b.backupTenancy),d[41].set("encryption_version",b.encryptionVersion),d[41].set("revision_version",b.revisionVersion),d[41].set("initialize_restore_result",void 0),d[41].set("device_creation_timestamp_sec",void 0),d[41].set("authority_level",b.authorityLevel),e=[d[41],void 0],d[20]=e[0],d[21]=e[1])})},function(a){return d[23]=new c.Map(),d[23].set("value",d[20]),d[23].set("errors",d[21]),d[24]=d[23].get("value"),d[24]!==void 0?c.sequence([function(a){return d[41]=d[24].get("backup_id"),d[42]=d[24].get("device_public_key_blob"),d[43]=d[24].get("device_private_key_blob"),d[44]=d[24].get("epoch_storage_public_key_blob"),d[45]=d[24].get("epoch_storage_private_key_blob"),d[46]=d[24].get("epoch_auth_public_key_blob"),d[47]=d[24].get("epoch_auth_private_key_blob"),d[48]=d[24].get("mailbox_root_key_blob"),d[49]=d[24].get("ocmf_client_state_blob"),d[50]=d[24].get("orf_client_state_v2_blob"),d[51]=d[24].get("orf_v2_authority_level"),d[52]=d[24].get("oblivious_validation_token_blob"),d[53]=d[24].get("device_id"),d[54]=d[24].get("backup_tenancy"),d[55]=d[24].get("encryption_version"),d[56]=d[24].get("revision_version"),d[57]=d[24].get("initialize_restore_result"),d[58]=d[24].get("device_creation_timestamp_sec"),d[59]=d[24].get("authority_level"),c.i64.neq(d[53],void 0)?c.sequence([function(a){return d[61]=void 0,c.i64.neq(d[61],void 0)?c.resolve(d[62]=d[61]):c.sequence([function(a){return d[65]=c.createArray(),c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,0])).then(function(a){return a=a,d[66]=a[0],a})},function(a){return d[66]?d[75]=(d[65].push(c.i64.cast([0,0])),d[65]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,2])).then(function(a){return a=a,d[67]=a[0],a})},function(a){return d[67]?d[75]=(d[65].push(c.i64.cast([0,2])),d[65]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,3])).then(function(a){return a=a,d[68]=a[0],a})},function(a){return d[68]?d[75]=(d[65].push(c.i64.cast([0,3])),d[65]):0,c.storedProcedure(b("LSIsEncryptionVersionSecure"),c.i64.cast([0,4])).then(function(a){return a=a,d[69]=a[0],a})},function(a){return d[69]?d[75]=(d[65].push(c.i64.cast([0,4])),d[65]):0,d[70]=c.createArray(),d[71]=c.i64.of_int32(d[65].length),c.i64.gt(d[71],c.i64.cast([0,0]))?c.loopAsync(d[71],function(a){return d[75]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[65],d[75]).then(function(a){return a=a,d[76]=a[0],d[77]=a[1],a})},function(a){return d[78]=(d[70].push(d[76]),d[70])}])}):c.resolve()},function(a){return c.sequence([function(a){return d[75]=c.createArray(),d[76]=c.i64.of_int32(d[70].length),c.i64.gt(d[76],c.i64.cast([0,0]))?c.loopAsync(d[76],function(a){return d[78]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[70],d[78]).then(function(a){return a=a,d[79]=a[0],d[80]=a[1],a})},function(a){return d[81]=(d[75].push(c.i64.to_string(d[79])),d[75])}])}):c.resolve()},function(a){return d[77]=d[75].join(","),d[72]=d[77]}])},function(a){return d[70].some(function(a){return c.i64.eq(d[55],a)})?d[73]=d[55]:d[73]=void 0,c.i64.neq(d[73],void 0)?d[74]=d[73]:d[74]=void 0,d[62]=d[74]}])},function(a){return c.i64.neq(d[62],void 0)?d[63]=d[62]:d[63]=c.i64.cast([0,0]),c.i64.neq(d[54],void 0)?d[64]=d[54]:d[64]=c.i64.cast([0,1]),d[60]=d[53]}]):c.resolve(d[60]=void 0)},function(a){return d[25]=d[60]}]):c.resolve((d[41]=d[23].get("errors"),d[42]=d[23].get("errors"),d[25]=void 0))},function(e){return d[26]=a[5].get("restore_task_source"),c.nativeOperation(b("LSDeserializeFromJsonIntoDictionaryV2.nop"),a[6]).then(function(a){return a=a,d[27]=a[0],a})},function(a){return d[28]=new c.Map(),d[29]=d[27].keys(),d[30]=c.i64.of_int32(d[29].length),c.i64.gt(d[30],c.i64.cast([0,0]))?c.loopAsync(d[30],function(a){return d[41]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[29],d[41]).then(function(a){return a=a,d[42]=a[0],d[43]=a[1],a})},function(a){return d[44]=d[27].get(d[42]),d[28].set(d[42],d[44])}])}):c.resolve()},function(a){return d[31]=d[28].get("query"),d[32]=new c.Map(),d[33]=d[31].keys(),d[34]=c.i64.of_int32(d[33].length),c.i64.gt(d[34],c.i64.cast([0,0]))?c.loopAsync(d[34],function(a){return d[41]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[33],d[41]).then(function(a){return a=a,d[42]=a[0],d[43]=a[1],a})},function(a){return d[44]=d[31].get(d[42]),d[32].set(d[42],d[44])}])}):c.resolve()},function(e){return d[35]=d[32].get("__typename"),d[35]==="MPSMessagePointQuery"?c.sequence([function(a){return d[41]=d[32].get("__typename"),d[41]==="MPSMessagePointQuery"?d[42]=d[32]:d[42]=void 0,d[42]?d[43]=!1:d[43]=!0,d[43]?c.resolve(d[44]=void 0):c.sequence([function(a){return d[45]=d[42].get("otids"),d[46]=c.createArray(),d[47]=c.i64.of_int32(d[45].length),c.i64.gt(d[47],c.i64.cast([0,0]))?c.loopAsync(d[47],function(a){return d[50]=a,c.sequence([function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[45],d[50]).then(function(a){return a=a,d[51]=a[0],d[52]=a[1],a})},function(a){return d[53]=(d[46].push(d[51]),d[46])}])}):c.resolve()},function(a){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),d[46],c.i64.cast([0,0])).then(function(a){return a=a,d[48]=a[0],d[49]=a[1],a})},function(a){return d[44]=d[48]}])},function(e){return a[9]!==void 0?d[44]!==void 0?c.nativeOperation(b("LSQplAnnotateString.nop"),c.i64.cast([0,679687866]),a[9],"message_id",d[44]):c.resolve():c.resolve()},function(a){return d[36]="POINT_QUERY_RESTORE"}]):c.resolve((d[41]=d[32].get("__typename"),d[41]==="MPSMessageRangeQuery"?d[42]="RANGE_QUERY_RESTORE":(d[43]=d[32].get("__typename"),d[43]==="MPSMessageSurroundingQuery"?d[44]="SURROUNDING_RESTORE":(d[45]=d[32].get("__typename"),d[45]==="MPSTaggedRangeQuery"?d[46]="TAGGED_RANGE_QUERY_RESTORE":d[46]="unknown_query_type",d[44]=d[46]),d[42]=d[44]),d[36]=d[42]))},function(e){return a[9]!==void 0?d[36]!==void 0?c.nativeOperation(b("LSQplAnnotateString.nop"),c.i64.cast([0,679687866]),a[9],"restore_type",d[36]):c.resolve():c.resolve()},function(d){return a[9]!==void 0?a[2]!==void 0?c.nativeOperation(b("LSQplAnnotateString.nop"),c.i64.cast([0,679687866]),a[9],"act_thread_id",a[2]):c.resolve():c.resolve()},function(e){return a[9]!==void 0?d[19]!==void 0?c.nativeOperation(b("LSQplAnnotateString.nop"),c.i64.cast([0,679687866]),a[9],"request_id",d[19]):c.resolve():c.resolve()},function(e){return d[38]=c.i64.to_string(d[25]),a[9]!==void 0?d[38]!==void 0?c.nativeOperation(b("LSQplAnnotateString.nop"),c.i64.cast([0,679687866]),a[9],"device_id",d[38]):c.resolve():c.resolve()},function(e){return d[39]=c.i64.to_string(d[26]),a[9]!==void 0?d[39]!==void 0?c.nativeOperation(b("LSQplAnnotateString.nop"),c.i64.cast([0,679687866]),a[9],"task_creation_source",d[39]):c.resolve():c.resolve()},function(d){return a[9]!==void 0?c.nativeOperation(b("LSQplMarkPoint.nop"),c.i64.cast([0,679677570]),a[9],"handle_restore_response"):c.resolve()},function(d){return a[9]!==void 0?c.nativeOperation(b("LSQplMarkEnd.nop"),c.i64.cast([0,679677570]),a[9],!1):c.resolve()},function(e){return d[16]!==void 0?(d[41]=d[16].get("error_code"),d[37]=["LSEBPayloadSerializerError","_",c.i64.to_string(d[41])].join("")):d[37]="unknown_failure",d[40]=["LSEncryptedBackupsHandleMessageWithProtobufsRestoreV2StoredProcedure",".",d[37]].join(""),a[9]!==void 0?d[40]!==void 0?c.nativeOperation(b("LSQplAnnotateString.nop"),c.i64.cast([0,679687866]),a[9],"error",d[40]):c.resolve():c.resolve()},function(d){return a[9]!==void 0?c.nativeOperation(b("LSQplMarkEnd.nop"),c.i64.cast([0,679687866]),a[9],!1):c.resolve()}]):c.resolve()}]):c.sequence([function(d){return a[9]!==void 0?c.nativeOperation(b("LSQplMarkPoint.nop"),c.i64.cast([0,679677570]),a[9],"handle_restore_response"):c.resolve()},function(d){return a[9]!==void 0?c.nativeOperation(b("LSQplMarkEnd.nop"),c.i64.cast([0,679677570]),a[9],!0):c.resolve()},function(d){return a[9]!==void 0?c.nativeOperation(b("LSQplMarkPoint.nop"),c.i64.cast([0,679687866]),a[9],"handle_restore_response"):c.resolve()},function(d){return a[9]!==void 0?c.nativeOperation(b("LSQplMarkEnd.nop"),c.i64.cast([0,679687866]),a[9],!0):c.resolve()},function(b){return d[17]=a[5].get("restore_task_source"),c.i64.eq(d[17],c.i64.cast([0,58]))?0:0}])}])},function(a){return d[9]=c.i64.of_float(Date.now()),d[10]=c.i64.random(),d[12]="Finishing execution. Execution time: ",d[13]=c.i64.to_string(c.i64.sub(d[9],d[0])),d[14]=" ms",d[11]="",function(a){c.logger(a).info(a)}(["[EncryptedBackups][handleMessageWithProtobufsRestoreV2] ",d[11],d[12],d[11],d[13],d[11],d[14]].join("")),c.i64.eq(c.i64.mod_(d[10],c.i64.cast([0,1e3])),c.i64.cast([0,0]))?(d[15]=",",d[16]=c.createArray(),void 0!==void 0?d[17]=(d[16].push(void 0),d[16]):0,c.nativeOperation(b("LSLogMebClientEvent.nop"),"handleMessageWithProtobufsRestoreV2",[d[12],d[15],d[13],d[15],d[14]].join(""),d[16],c.i64.cast([0,4]))):c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSEncryptedBackupsHandleMessageWithProtobufsRestoreV2StoredProcedure";a.__tables__=["secure_encrypted_backups_client_state"];e.exports=a}),null);